<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COSMIC | Advanced Visualization</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --bg-darker: #020408;
            --bg-panel: #0a0d14;
            --cosmic-blue: #00f2ff;
            --neon-purple: #bc13fe;
            --text-main: #e0e6ed;
            --text-dim: #64748b;
            --border: rgba(0, 242, 255, 0.15);
            --terminal-font: 'JetBrains Mono', monospace;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: var(--bg-darker); 
            color: var(--text-main); 
            display: flex; 
            height: 100vh; 
            overflow: hidden; 
            font-family: 'Inter', sans-serif;
        }

        /* --- UNIFIED SIDEBAR --- */
        nav {
            width: 260px;
            background: var(--bg-panel);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            padding: 30px 20px;
            flex-shrink: 0;
            z-index: 50;
        }

        .nav-logo {
            font-weight: 800;
            color: var(--cosmic-blue);
            letter-spacing: 3px;
            margin-bottom: 40px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.2rem;
        }

        .nav-group-label {
            font-size: 0.90rem;
            color: white;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin: 20px 0 10px 10px;
        }

        .nav-item {
            padding: 12px 15px;
            color: var(--text-dim);
            text-decoration: none;
            margin-bottom: 4px;
            border-radius: 8px;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.9rem;
        }

        .nav-item:hover {
            background: rgba(0, 242, 255, 0.05);
            color: var(--cosmic-blue);
        }

        .nav-item.active {
            background: rgba(0, 242, 255, 0.1);
            color: var(--cosmic-blue);
            border-left: 3px solid var(--cosmic-blue);
            font-weight: 600;
        }

        /* --- CONTENT AREA --- */
        .viewport { flex: 1; display: flex; flex-direction: column; overflow: hidden; position: relative; }

        .glass-card { 
            background: rgba(15, 23, 42, 0.4); 
            border: 1px solid rgba(51, 65, 85, 0.3); 
            backdrop-filter: blur(10px);
            border-radius: 1rem; 
        }

        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }

        #starCanvas { background: radial-gradient(circle at center, #0f172a 0%, #050a15 100%); }
    </style>
</head>
<body>

    <nav id="main-sidebar">
        <div class="nav-logo">
            <i data-lucide="orbit" class="w-8 h-8"></i> COSMIC
        </div>
        
        <p class="nav-group-label">Core</p>
        <a href="Dashboard.html" class="nav-item" id="nav-dashboard">
            <i class="fas fa-th-large"></i> Dashboard
        </a>
        <a href="Data_Ingestion_Page.html" class="nav-item" id="nav-ingestion">
            <i class="fas fa-upload"></i> Data Ingestion
        </a>
        <a href="Central_Data_Repository.html" class="nav-item" id="nav-repository">
            <i class="fas fa-server"></i> Repository
        </a>
        
        <p class="nav-group-label">Analysis</p>
        <a href="Visualization_Page.html" class="nav-item" id="nav-visualization">
            <i class="fas fa-expand"></i> Visualization
        </a>
        <a href="AI_Insights_Page.html" class="nav-item" id="nav-ai">
            <i class="fas fa-brain"></i> AI Insights
        </a>

        <p class="nav-group-label" style="margin-top:auto">Admin</p>
        <a href="Authentication_Page.html" class="nav-item" id="nav-governance">
            <i class="fas fa-shield-alt"></i> Governance
        </a>
        <a href="Settings.html" class="nav-item" id="nav-settings">
            <i class="fas fa-cog"></i> Settings
        </a>
    </nav>

    <div class="viewport">
        <header class="h-16 border-b border-slate-800/40 flex items-center justify-between px-8 bg-[#050a15]/90 backdrop-blur-md z-10">
            <div class="flex items-center gap-6">
                <h2 class="text-sm font-bold text-white uppercase tracking-widest">Astro Data Explorer</h2>
                <div class="flex bg-slate-900 rounded-lg p-1 border border-slate-800">
                    <button id="gridBtn" onclick="toggleLayout('grid')" class="px-3 py-1 rounded text-xs bg-slate-800 text-cyan-400 font-bold shadow-lg">Grid View</button>
                    <button id="compareBtn" onclick="toggleLayout('compare')" class="px-3 py-1 rounded text-xs text-slate-500 hover:text-white transition">Side-by-Side</button>
                </div>
            </div>
            
            <div class="flex items-center gap-4">
                <button onclick="downloadCSV()" class="p-2 hover:bg-slate-800 rounded-lg text-slate-400 transition" title="Download CSV">
                    <i data-lucide="download" class="w-5 h-5"></i>
                </button>
                <button class="bg-cyan-600 hover:bg-cyan-500 text-white text-xs px-5 py-2 rounded-lg font-bold transition shadow-lg shadow-cyan-900/20">
                    Share Research
                </button>
            </div>
        </header>

        <div id="dashboardContent" class="flex-1 p-6 overflow-y-auto custom-scrollbar">
            <div class="glass-card p-4 mb-6 grid grid-cols-4 gap-6 items-center">
                <div class="col-span-1">
                    <label class="text-[10px] uppercase tracking-widest text-slate-500 font-bold mb-1 block">Frequency Range</label>
                    <select class="w-full bg-slate-900/50 border border-slate-700 rounded p-2 text-xs text-cyan-400 outline-none">
                        <option>Visible Spectrum (V-Band)</option>
                        <option>X-Ray (0.1–10 keV)</option>
                        <option>Infrared (1–25 μm)</option>
                    </select>
                </div>
                <div class="col-span-1 border-l border-slate-800 pl-6">
                    <label class="text-[10px] uppercase tracking-widest text-slate-500 font-bold mb-1 block">Overlay Datasets</label>
                    <div class="flex gap-2">
                        <span class="bg-blue-900/40 text-blue-400 text-[10px] px-2 py-1 rounded border border-blue-800/50">Gaia DR3</span>
                        <span class="bg-purple-900/40 text-purple-400 text-[10px] px-2 py-1 rounded border border-purple-800/50">Hubble</span>
                    </div>
                </div>
                <div class="col-span-2 flex justify-end gap-2">
                    <button class="px-4 py-2 rounded-lg bg-slate-800 text-xs text-slate-300 flex items-center gap-2 border border-slate-700">
                        <i data-lucide="zoom-in" class="w-3 h-3"></i> Zoom / Pan
                    </button>
                    <button class="px-4 py-2 rounded-lg bg-slate-800 text-xs text-slate-300 flex items-center gap-2 border border-slate-700">
                        <i data-lucide="filter" class="w-3 h-3"></i> Apply Filters
                    </button>
                </div>
            </div>

            <div id="mainGrid" class="grid grid-cols-2 gap-6 h-[800px]">
                <div class="glass-card p-5 flex flex-col overflow-hidden">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-tighter flex items-center gap-2">
                            <i data-lucide="map" class="w-4 h-4 text-cyan-400"></i> Sky Map Distribution
                        </h3>
                    </div>
                    <div class="flex-1 rounded-xl overflow-hidden relative border border-slate-800">
                        <canvas id="starCanvas" class="w-full h-full"></canvas>
                    </div>
                </div>

                <div class="glass-card p-5 flex flex-col">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-tighter flex items-center gap-2">
                            <i data-lucide="activity" class="w-4 h-4 text-rose-500"></i> Light Curve
                        </h3>
                        <span class="text-[9px] bg-rose-500/10 text-rose-400 px-2 py-0.5 rounded border border-rose-500/20">LIVE</span>
                    </div>
                    <div class="flex-1"><canvas id="lightCurveChart"></canvas></div>
                </div>

                <div id="spectralCard" class="glass-card p-5 col-span-2 flex flex-col">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-tighter flex items-center gap-2">
                            <i data-lucide="waves" class="w-4 h-4 text-purple-400"></i> Spectral Flux
                        </h3>
                    </div>
                    <div class="flex-1 min-h-[300px]"><canvas id="spectralChart"></canvas></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // 1. AUTO-HIGHLIGHT NAV
        function highlightActivePage() {
            const path = window.location.pathname;
            const page = path.split("/").pop();
            const navItems = document.querySelectorAll('.nav-item');
            
            navItems.forEach(item => {
                const href = item.getAttribute('href');
                if (page === href) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            if (page === "" || page === "index.html") {
                document.getElementById('nav-dashboard').classList.add('active');
            }
        }
        window.onload = highlightActivePage;

        // 2. SKY MAP ANIMATION
        const canvas = document.getElementById('starCanvas');
        const ctx = canvas.getContext('2d');
        let stars = [];

        function resizeCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            initStars();
        }

        function initStars() {
            stars = [];
            for(let i=0; i<200; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * 1.5,
                    color: Math.random() > 0.8 ? '#00ffff' : '#ffffff'
                });
            }
        }

        function animateStars() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            stars.forEach(s => {
                ctx.globalAlpha = Math.abs(Math.sin(Date.now() * 0.001 + s.x));
                ctx.fillStyle = s.color;
                ctx.beginPath();
                ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
                ctx.fill();
            });
            requestAnimationFrame(animateStars);
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        animateStars();

        // 3. CHARTS INITIALIZATION (Keep your existing Chart.js logic)
        const lightCtx = document.getElementById('lightCurveChart').getContext('2d');
        new Chart(lightCtx, {
            type: 'line',
            data: {
                labels: Array.from({length: 50}, (_, i) => i),
                datasets: [{
                    data: Array.from({length: 50}, () => 0.95 + Math.random() * 0.05),
                    borderColor: '#f43f5e',
                    borderWidth: 1.5,
                    pointRadius: 0,
                    tension: 0.4,
                    fill: true,
                    backgroundColor: 'rgba(244, 63, 94, 0.05)'
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } },
                scales: { x: { display: false }, y: { grid: { color: '#1e293b' }, ticks: { color: '#64748b' } } }
            }
        });

        const specCtx = document.getElementById('spectralChart').getContext('2d');
        new Chart(specCtx, {
            type: 'bar',
            data: {
                labels: ['Gamma', 'X-Ray', 'UV', 'Visible', 'Near-IR', 'Mid-IR', 'Radio'],
                datasets: [{ label: 'Flux', data: [15, 45, 12, 85, 30, 10, 5], backgroundColor: '#06b6d4' }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } },
                scales: { x: { grid: { display: false }, ticks: { color: '#64748b' } }, y: { grid: { color: '#1e293b' } } }
            }
        });

        function toggleLayout(mode) {
            const grid = document.getElementById('mainGrid');
            const specCard = document.getElementById('spectralCard');
            if(mode === 'compare') {
                grid.classList.replace('grid-cols-2', 'grid-cols-1');
                specCard.classList.remove('col-span-2');
            } else {
                grid.classList.replace('grid-cols-1', 'grid-cols-2');
                specCard.classList.add('col-span-2');
            }
        }
    </script>
</body>
</html>